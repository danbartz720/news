<!DOCTYPE html>
<html>
   
   <head>
      <title>News Aggregation</title>
      <meta name = "viewport" content = "width = device-width, initial-scale = 1.0">
      
      <!-- Bootstrap -->
      <link href = "css/bootstrap.min.css" rel = "stylesheet">
	  <link href = "css/main.css" rel = "stylesheet">
	  
      
      <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
      <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
      
      <!--[if lt IE 9]>
      <script src = "https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src = "https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
      <![endif]-->
      
	  <script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<script src="http://www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.js"
		type="text/javascript"></script>

		<style type="text/css">
		@import url("http://www.google.com/uds/solutions/dynamicfeed/gfdynamicfeedcontrol.css");


		</style>
		<script type="text/javascript">
		function load() {
			var feeds = [
			   {title:'ESPN Sports Headlines',
				url:'http://espn.go.com/espn/rss/news'},
			   {title:'ABC: Top Stories',
				url:'http://feeds.abcnews.com/abcnews/topstories'}];
			var feed ="http://feeds.reuters.com/reuters/topNews";
			new GFdynamicFeedControl(feeds, "feedControl", 
				{numResults : 8, stacked: true, title: "Multi-Feed"});
			
		}
		google.load("feeds", "1");
		google.setOnLoadCallback(load);

		</script>
		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
      	<script src = "https://code.jquery.com/jquery.js"></script>
   </head>
   
   <body>

      
      
      <!-- Include all compiled plugins (below), or include individual files as needed -->
      <script src = "js/bootstrap.min.js"></script>
	  
	  <div class = "container centered">
   
   		<div class = "bg-primary row" id="head-content">
   			<div class = "logged-in-head last-visit col-xs-3" id="welcome-box">
   				Welcome <span class="userDisplay"></span>.<br>
   				Your last visit was on: <span class="timeDisplay"></span>.<br>
   			</div>
   			<div class = "main-col col-xs-6 text-left">
	   			<h1>News Aggregation</h1>
			</div>
   			<div class = "logged-in-head col-xs-3 text-right">
   				<br><button type="button" class="btn btn-danger btn-sm">Logout</button>	
   			</div>

   		</div>
   		<div class="row" id="auth-row">
   			<div class="auth-box">
		  		<input type="text" class="form-control" id="username" placeholder="Username">
		  		<input type="password" class="form-control" id="password" placeholder="Password">
				<div class="btn-group btn-group-justified">
					<div class="btn-group"><button type="button" class="btn btn-default" id="create-acct-btn">Create Account</button></div>
					<div class="btn-group"><button type="button" class="btn btn-primary" id="login-btn">Login</button></div>
				</div>
			</div>
			<div class="err-box text-danger" id="auth-errs"></div>
			<div class="success-box text-success" id="auth-success"></div>
   		</div>
	    <div class = "row" id="main-content">
			<div class = "col-xs-3" id="favorites">
				<h3>Favorites</h3>
				Text 1 here. ===================== ================= ===================== ================= ===================== ================= ===================== ================= 
			</div>
		    <div class = "col-xs-6" style="	border-right: 1px solid #ccc; border-left: 1px solid #ccc;">
				<div id="rssBody">
					<div id="feedControl" class= "feedControl">Loading...</div>
					<!--
					<div id="abcFeedControl" class= "feedControl">Loading...</div>
					-->
				</div>
			</div>
				
		    <div class = "col-xs-3" id="filters">
		    	<h3>Content Filters</h3>
		    	<label class="checkbox active">
				  <input type="checkbox" checked>US News
				</label>
				<label class="checkbox active">
				  <input type="checkbox" checked>World News
				</label>
				<label class="checkbox active">
				  <input type="checkbox" checked>Sports
				</label>
				<label class="checkbox active">
				  <input type="checkbox" checked>Weather
				</label>
				<label class="checkbox active">
				  <input type="checkbox" checked>Technology
				</label>

		    </div>
	    </div>
	
	</div>


      
	<script>
		/*
			PUT EVERYTHING HERE
		*/
		$(document).ready(function(){
			$("#create-acct-btn").click(function(){
				$("#auth-errs").text("");
				$("#auth-success").text("");
				$.ajax({
					method: "POST",
					url: "create-account.php",
					data: {
						username: $("#username").val(),
						password: $("#password").val()
					},
					dataType: "json",
					success: function(data, status){
						if (data.errCode == 1){
							// Username already exists
							$("#auth-errs").text(data.errText);
						} else {
							// Account creation successful
							$("#login-success").text(data.successText);
						}
					},
					error: function(data, status, errorThrown){
						//alert("ERROR: " + JSON.stringify(data) + " " + status + " " + errorThrown);
					}
				});
			});


			$("#login-btn").click(function(){
				$("#auth-errs").text("");
				$("#acct-created").text("");
				$.ajax({
					method: "POST",
					url: "login.php",
					data: {
						username: $("#username").val(),
						password: $("#password").val()
					},
					dataType: "json",
					success: function(data, status){
						if(data.errCode == 1){
							// Bad password
							$("#auth-errs").text(data.errText);
						} else if (data.errCode == 2){
							// Nonexistant username
							$("#auth-errs").text(data.errText);
						} else {
							// Login successful
							$(".auth-box").hide();
							$(".logged-in-head").css("opacity", 1);
							$("#main-content").show();
							$(".userDisplay").text(data.username);
							// TO-DO: Fill with cookie data for datetime.
							$(".timeDisplay").text("Fill with cookie data")
						}
				    },
					error: function(data, status, errorThrown){
						//alert("ERROR: " + JSON.stringify(data) + " " + status + " " + errorThrown);
					}
				});
			});




		});
	</script>
   	</body>
</html>